# 多因子认证系统手动测试指南

## 测试环境准备

1. 启动应用服务器：
```bash
export PYTHONPATH=.
export FLASK_ENV=development
python web/app.py
```

2. 安装TOTP认证器应用（如Google Authenticator）到手机

## 测试场景

### 1. 基本登录流程测试

#### 1.1 新用户注册
1. 访问 http://localhost:5000
2. 输入任意用户名和密码（如：test_user/test_password）
3. 系统会自动创建用户并显示TOTP二维码
4. 使用手机扫描二维码或手动输入密钥
5. 在认证器应用中查看生成的6位动态密码
6. 将动态密码输入到网页中验证

#### 1.2 已注册用户登录
1. 使用已注册的用户名和密码登录
2. 使用认证器应用生成的动态密码验证

### 2. 错误场景测试

#### 2.1 登录失败
1. 输入错误的用户名或密码
2. 验证错误提示信息
3. 验证是否可以继续尝试登录

#### 2.2 TOTP验证失败
1. 完成第一步登录
2. 输入错误的动态密码
3. 验证错误提示信息
4. 验证是否可以重新输入

### 3. 安全限制测试

#### 3.1 登录尝试次数限制
1. 使用错误的密码连续尝试登录
2. 验证是否在5次尝试后显示限制信息
3. 等待15分钟后再次尝试

#### 3.2 会话超时
1. 完成第一步登录
2. 等待15分钟
3. 尝试输入动态密码
4. 验证是否提示会话过期

### 4. 界面功能测试

#### 4.1 响应式设计
1. 在不同设备上访问（手机、平板、电脑）
2. 验证界面是否正常显示
3. 验证所有功能是否可用

#### 4.2 用户体验
1. 验证输入框的必填验证
2. 验证错误提示的显示和消失
3. 验证按钮的状态变化

## 测试数据

### 测试用户
1. 新用户：
   - 用户名：test_user
   - 密码：test_password

2. 错误测试：
   - 用户名：wrong_user
   - 密码：wrong_password

### 预期结果

1. 登录成功：
   - 显示TOTP二维码和密钥
   - 可以继续TOTP验证

2. 登录失败：
   - 显示错误信息
   - 可以重新尝试

3. TOTP验证成功：
   - 显示成功消息
   - 页面刷新

4. TOTP验证失败：
   - 显示错误信息
   - 可以重新输入

## 注意事项

1. 测试环境使用模拟认证，不需要真实的Kerberos服务器
2. 数据库使用SQLite，数据存储在instance目录下
3. 测试时注意观察服务器日志，查看是否有异常信息
4. 如果遇到问题，可以删除数据库文件重新开始测试 